Ak@Ne! Version 1.2.1
作者:Angelic Sotware(作成者：砂倉瑞希)

対応OS：WindowsXP/2003/2008/Vista/7/8(.NET Framework 4.0以降に対応している環境)
※Windows RTはCPUの互換性がないため動作しません。

メモリ：256MB以上を推奨(全環境)
ハードディスク：1MB以上(USBメモリ運用が可能なように設定をファイルにしています。)

■概要

  POP3/APOP/POP3 over SSL/TLS/SMTP_AUTH対応メールソフトです。
  Mail Viewerの改善点を追加し、さらに新たな機能を追加する予定です。


■インストール

  圧縮ファイルに同梱されているファイルを任意のフォルダに
  コピーするだけでインストールは完了します。


■アンインストール

  Ak@Ne!のフォルダごと削除を行えばOKです。(レジストリは使用していません)


■ファイル内容(akane121.lzh)

  ・ AkaneMail.exe   (Ak@Ne! Version 1.2.1本体)
  ・ readme.txt      (このファイル)
  ・ nMail.dll       (nMail.dll Version 3.10 32bit (C)軟式)
  ・ nMail.dll.64    (nMail.dll Version 3.10 64bit (C)軟式)
  ・ MailConvert.exe (Ak@Ne! Mail Converter Version 1.0.1)
  ・ ACryptLib.dll   (Akane Mail Crypt Library Version 1.0.0)

  注意：将来フォルダ、ファイル構成が変わる場合があります


■64bit版OSで実行する場合の注意
  64bit版のWindowsXP、Windows Vista、Windows7、Windows2008 Serverの場合
  インストール後にフォルダのnMail.dllをnMail.dll.32に、nMail.dll.64を
  nMail.dllにファイル名を変更する必要があります。

  インストール直後の状態で起動致しますとエラーが表示されてアプリケーションが
  終了するようにしていますので必ずこの作業を行ってください。


■ver1.0.1またはver1.1.0からver1.2.1へデータ移行する場合の注意
  nMail.dll ver1.30で受信したメールを使用してnMail.dll ver1.31の展開機能で
  メールを展開すると二重デコードが発生し、HTMLメールなどが正しく表示できない
  ため、ver1.1.0で使用可能なデータに変換できるツールを同梱しました。

  またver1.2.0へのバージョンアップに伴う新機能のためファイル構造が変更されたため
  必ず変換ツールを実行してください。

  同梱のMailConvert.exeを実行しメールデータを変換(C)をクリックし、ver1.0.1または
  ver1.1.0で使用しているメールデータ(Mail.dat)を指定し、変換を行ってください。
  変換できたMail.datをver1.2.1のフォルダに格納してください。


■使い方

  ■メールの設定
    AkaneMail.exeを起動してメニューの[ツール(T)]-[環境設定(S)]のダイアログを表示して
    [名前]、[メールアドレス]、[ユーザ名]、[パスワード]、[POP3サーバ]、[SMTPサーバ]を
    入力してください。

    以下の設定は必要時に応じて設定してください。
    [ポート番号]                             … POP3とSMTPのポート番号を設定します。
    [APOPを有効にする]                       … APOP機能を有効にします。
    [メール受信時にメールを削除する]         … メールを受信したときにPOP3サーバからメールを削除します。
    [POP before SMTPを有効にする]            … POP before SMTP機能を有効にします。
    [POP3 over SSL/TLSを有効にする]          … POP3 over SSL/TLS機能を有効にします。
    [SMTP認証を有効にする]                   … SMTP_AUTH機能を有効にします。(ただし現在はPOP3とユーザ名とパスワードが同じ時のみ利用できます。)
    [自動受信を有効にする]                   … 1～120分間隔で自動的にメールを受信する機能を有効にします。
    [着信音を鳴らす]                         … メール受信時に着信音(WAVファイル)を鳴らす機能を有効にします。
    [HTMLメールをIEコンポーネントで表示する] … HTMLメール表示時にInternet Explorerの部品でメールを表示します。
    [最小化時にタスクトレイに格納する]       … ウィンドウを最小化した際にタスクトレイに格納します。

  ■メールの受信
    メニューの[メール(M)]-[受信(M)]でPOP3サーバからのメール受信を行います。

  ■メールの送信
    送信箱に未送信のメールがある場合、メニューの[メール(M)]-[送信(S)]
    またはツールボタンの送信を押してメールを送信出来ます。

    Pop Before to SMTPの機能を標準装備なのでYahoo!メールなどの
    Pop Before to SMTPが必要なサーバでもメールの送信が可能です。

  ■メールの新規作成
    メニューの[メール(M)]-[新規作成(N)]またはツールボタンの新規作成を
    押すと新しいメールが作成できます。
    メールの作成が完了した時はメニューの[ファイル(F)]-[直接送信(S)]
    [ファイル(F)]-[送信箱に入れる(B)]、またはツールボタンの直接送信、
    送信箱に入れるを押してメールを送信(※)します。

    添付ファイル付きメールを送信したい場合はメニューの[ファイル(F)]-[ファイルの添付(A)]または
    ツールボタンのファイルの添付を押して添付したいファイルを添付してください。
    添付ファイルの削除は添付後にステータスバーの右下に表示されるファイルアイコンから削除したい
    添付ファイルをクリックして削除します。(送信メールの添付ファイルリストから削除されるだけなので
    添付していたファイルは削除されません)

    ※送信箱に入れるを選択した場合は別途メイン画面の[メール(M)]-[送信(S)]または
      ツールボタンの送信を押してメールを送信する必要があります。

  ■メールの返信
    返信したい件名をクリックして右クリックで[返信(R)]
    または[メール(M)]-[返信(R)]、ツールボタンの返信で行う事ができます。

  ■メールの転送[New!]
    転送したい件名をクリックして右クリックで[転送(T)]
    または[メール(M)]-[転送(T)]、ツールボタンの転送で行う事ができます。

  ■メールの削除
    削除したい件名をクリック(複数選択可)して右クリックで[削除(D)]
    または[メール(M)]-[メールの削除(D)]、ツールボタンの削除で行う事ができます。
    受信メールまたは送信メールで削除したメールはゴミ箱に移動されます。
    ゴミ箱からの削除は完全にデータが消えるため、必要なメールのときはメールの保存を行います。

  ■メールの保存
    保存したいメールの件名をクリックして[ファイル(F)]-[名前を付けて保存(A)]で
    保存が可能となっています。(1.1.0より受信メール以外も保存できるようになりました。)

  ■添付メールファイルの展開
    添付ファイルを展開したいメールを右クリックし[添付ファイルを取り出す(G)]または
    [ファイル(F)]-[添付ファイルを取り出す(G)]をクリックすると添付ファイルの展開先
    ディレクトリダイアログが表示されるので添付ファイルを保存するディレクトリを選択して
    [OK]ボタンを押すと添付されているファイルが展開されます。

  ■スプラッシュウィンドウについて
    Ak@Ne!と同じフォルダにakanemail.pngが存在する時はスプラッシュウィンドウの
    画像を変更することができます。(画像サイズは490x330です)


■開発履歴

  Ver 1.2.1(2013.07.16)

    開発環境をVisual Studio 2010に変更した影響による.NET2.0から4.0へのプラットフォーム変更。
    1.2.0からのちょっとした修正を実施。

  Ver 1.2.0(2010.08.12)
    追加
    ・メール新規作成フォームにCC、BCC、重要度の項目を追加。
    ・メールの重要度によってメールの件名色が変わる機能を追加。
    ・メニューとツールバーに転送機能を追加。
    ・ウィンドウサイズ、位置の保存を追加。

    修正
    ・メール送受信時に画面をクリックするとハングアップする問題を修正。(マルチスレッド化)
    ・iso-2022-jpとquoted-printableがヘッダに付いたメールが正しく表示できなかったのを修正。
    ・UTF-8でエンコードされたメールが正しく表示、返信できない問題を修正。
    ・その他細かい修正。

  Ver 1.1.0(2009.3.18)
    追加
    ・スプラッシュウィンドウの追加。
    ・最小化時にタスクトレイに格納する機能の追加。
    ・POP3パスワードの暗号化処理追加。(ACryptLib.dllの追加)
    ・メール送受信時にボタンを二度押しできないようにボタンの無効化をする処理を追加。
    ・nMail.dllの新APIに対応するためのメールデータ変換ツールを追加。

    変更
    ・HTMLメール表示方法の変更。(添付リストからの表示とIEコンポーネント表示)
    ・HTMLメールの返信時にHTMLタグが表示されないように変更。
    ・text/htmlのメールをIEコンポーネント表示Offの時にタグなしで表示するように変更。
    ・送信メールの添付一覧を表示可能に変更。
    ・メール新規作成フォームの宛先、件名でメニューまたはツールバーからの
      編集機能(元に戻す、切り取り、コピー、貼り付け、削除、すべて選択)を
      使用できるように変更。
    ・メール送信時(直接送信除く)にもプログレスバーを表示するように変更。
    ・POP before SMTP実施時にPOP3認証が取れなかった場合のエラー処理を変更。
    ・未使用のメニューを非表示に変更。([ヘルプ(H)]-[目次(C)])
    ・メールの削除・既読メールの未読変更を複数件できるように変更。
    ・メール受信やメール削除時にリストビューからフォーカスが外れないように変更。
    ・リストビュー比較クラスを文字列のみから文字列、日付、数値の比較に変更。
    ・新規メールを複数送れるようにフォームの呼び出し方法を変更。
    ・メール新規作成時の日付を"未送信"からメールを作成した時間に変更。
    ・新規メール作成時にテキスト入力領域が変更された状態でフォームが閉じられた時に
      確認ダイアログを出すように変更。
    ・ツリービューのメールボックスをクリックしたときにリスト側にメールデータの情報を
      表示するように変更。
    ・リストビューのサイズ表示を右揃えに変更。

    修正
    ・添付ファイルが1個の添付付きメールが作成できなかった問題を修正。
    ・起動時にファイル読み込みで無限ループに陥る問題を修正。
    ・メールファイル保存、添付ファイル展開可能フォルダを修正。
    ・添付ファイル付きメールの返信時に添付ファイルが付かないように修正。
    ・メール受信時のプログレスバーが正常に動作しない問題を修正。
    ・無駄にリスト・ツリー更新をしていた処理を修正。
    ・ツリークリック時に本文が残っていた問題を修正。
    ・カラムをクリックすると昇順、降順にメールを並べ替えれるように修正。
    ・メールの並び順を日付の降順で並べるように修正。
    ・メールフォルダの切り替え、メールの削除時にテキストが残ってしまっていた問題を修正。
    ・メール作成時刻表示をmm:ddからmm:dd:ssに修正。(受信メールと統一)
    ・新規メールフォームの背後に隠していたボタンを削除。(ダイアログ起動の時の名残り)
    ・新規メールフォームで送信箱に入れる、直接送信のボタン、メニューの順番を修正。
    ・新規メールフォームで宛先、本文が入っていない状態で送信箱に入れるまたは直接送信の
      ボタンまたはメニューをクリックしたときにエラーを表示するように修正。
    ・新規メール作成以降のメールサイズを表示するように修正。

  Ver 1.0.1(2008.9.20)
    ・バグを少しだけ修正。(内容を忘れてしまいました。)

  Ver 1.0.0(2008.8.9)
    ・初版完成


■免責
  本ソフトは無保証です。本ソフトウェアの使用によって被ったいかなる損害に
  ついても、本ソフトの開発者、開発元、提供者は一切責任を負いかねます。


■著作権･再配布等

  このソフトのプログラム部分の著作権はAngelic Software(砂倉瑞希)が所有し
  同梱しているライブラリnMail.DLLの著作権は(有)軟式、アイコンのキャラクタ
  あかね色に染まる坂の橘ミコトの著作権は有限会社ホワイトローズ内のfengが所有しています。

  プログラムの再配布はパッケージの中身を変えない限り配布を許諾します。


■ソースコードに関して
  Ak@Ne!のソースコードは修正BSDライセンスの元に公開をさせて頂いています。
  ・ソースコードは無保証であること。
  ・ソースコード等の著作権表示を削除しない条件の下での再配布許可。
  ・ソースコードの改変可能範囲は著作権を所有するソースコード、リソースのみとする。
  ・著作権者の条件を付け加えることが可能。(改変したソースコードの公開を必須とする)

  開発にご協力頂ける方はGitHubのAkane Mailのレポジトリよりソースコードを入手して
  開発して頂けるようお願い致します。

  機能の修正や追加を行った場合はプルリクエストを送って頂ければこちらで検証をして
  問題がなければ反映させて頂きます。

  著作権の関係により有限会社ホワイトローズより許諾を頂いている当アプリケーションの
  アイコン(橘ミコト)単体の再配布は行わないでください。

  また有償で配布する場合、有限会社軟式へライセンス料を支払う必要がございますので
  ご注意ください。


■仕様と既存のバグ

  ・メールデータを変換せずに新バージョンに置き換えて実行すると強制終了になる
    ⇒変換ツールで旧メールデータを変換しない限り実行できません。
      お手数をおかけしますが変換ツールでデータを変換して使用してください。

  ・64bitOSでインストール直後の環境で実行するとエラーメッセージが表示される
    ⇒「64bit版OSで実行する場合の注意」の作業を実行してから起動して下さい。

  ・eml形式で保存したファイルをOutlookなどで開いたら差出人の名前が文字化けする
    ⇒このソフトの仕様です。(修正は検討しています)


■参考文献・ライブラリ(敬称略)

・nMail.dll((有)軟式)
  POP3/APOP/SMTP対応メール送受信DLL(フリーウェア作成の場合のみフリーウェア)
  http://www.nanshiki.co.jp/lib/nmail.html

・VisualC#とBCLで作る Windowsプログラミング入門(矢沢久雄 著)
  第5章メールソフトプログラムを参考にして作成しています。
  http://www.sbcr.jp/books/products/detail.asp?sku=4797338946

・Codezine(翔泳社)
  マルチスレッド(どぼん氏による記事)などを参考にしています。
  http://codezine.jp/

・DOBON.NET .NET Tips(どぼん)
  文字列の暗号化/復号化などを参考にしています。
  http://dobon.net/vb/dotnet/

・feng Official Homepage
  あかね色に染まる坂を開発したfeng様のページです。(18才未満の方の閲覧をお断り致します)
  http://www.feng.jp/


開発者：Angelic Software(作成者：砂倉瑞希)
メール：floremilfia@hotmail.com
URL   ：http://www.angel-teatime.com/
        http://github.com/hijirichan/AkaneMail

